{"version":3,"file":"static/webpack/static/development/pages/_app.js.8388262fa59052aefd29.hot-update.js","sources":["webpack:///./api/firebase.ts"],"sourcesContent":["import * as firebase from \"firebase\";\nimport \"firebase/database\";\n\nconst config = {\n  apiKey: \"AIzaSyDp01-0TwxRjNC05CuDcpauXRyLSMv0RRw\",\n  authDomain: \"darts-yeslab.firebaseapp.com\",\n  databaseURL: \"https://darts-yeslab.firebaseio.com\",\n  projectId: \"darts-yeslab\",\n  storageBucket: \"darts-yeslab.appspot.com\",\n  messagingSenderId: \"426404952698\",\n  appId: \"1:426404952698:web:738ac9ab1342a1177419c3\",\n  measurementId: \"G-7DHLMBZXEN\"\n};\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(config);\n  firebase.database();\n}\n\n// DB types\ndeclare global {\n  interface User {\n    id: string;\n    date_joined: number;\n  }\n\n  interface Error {\n    message: string;\n  }\n}\n\nexport function getUser(userId: string): Promise<User> {\n  return firebase\n    .database()\n    .ref(\"/users/\" + userId)\n    .once(\"value\")\n    .then(function(snapshot) {\n      const user = snapshot.val();\n      console.log(\"user\", user);\n      if (user) {\n        return user;\n      }\n\n      return createUser(userId);\n    });\n}\n\nfunction createUser(userId): Promise<User> {\n  const user = {};\n\n  console.log(\"create user for: \", userId);\n  return new Promise((resolve, reject) => {\n    firebase\n      .database()\n      .ref(\"users/\" + userId)\n      .set(user, error => {\n        if (error) {\n          reject(error.message);\n        }\n\n        resolve({ ...user, id: userId });\n      });\n  });\n}\n\n// const data = {\n//   games: {\n//     \"one\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"7yzh\"\n//     },\n//     \"two\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"8n0a\"\n//     }\n//   }\n\n// }\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;A","sourceRoot":""}