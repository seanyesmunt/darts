{"ast":null,"code":"import * as firebase from \"firebase\";\nimport \"firebase/database\";\nconst config = {\n  apiKey: \"AIzaSyDp01-0TwxRjNC05CuDcpauXRyLSMv0RRw\",\n  authDomain: \"darts-yeslab.firebaseapp.com\",\n  databaseURL: \"https://darts-yeslab.firebaseio.com\",\n  projectId: \"darts-yeslab\",\n  storageBucket: \"darts-yeslab.appspot.com\",\n  messagingSenderId: \"426404952698\",\n  appId: \"1:426404952698:web:738ac9ab1342a1177419c3\",\n  measurementId: \"G-7DHLMBZXEN\"\n};\nconst app = firebase.initializeApp();\nconst database = firebase.database(); // DB types\n\nexport function getUser(userId) {\n  return firebase.database().ref(\"/users/\" + userId).once(\"value\").then(function (snapshot) {\n    const user = snapshot.val();\n\n    if (user) {\n      return user;\n    }\n\n    return createUser(userId);\n  });\n}\n\nfunction createUser(userId) {\n  const user = {};\n  return firebase.database().ref(\"users/\" + userId).set(user, error => {\n    if (error) {\n      throw Error(error);\n    }\n\n    return user;\n  });\n} // const data = {\n//   games: {\n//     \"one\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"7yzh\"\n//     },\n//     \"two\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"8n0a\"\n//     }\n//   }\n// }","map":{"version":3,"sources":["/Users/sean/Workspace/darts/api/firebase.ts"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","app","initializeApp","database","getUser","userId","ref","once","then","snapshot","user","val","createUser","set","error","Error"],"mappings":"AAAA,OAAO,KAAKA,QAAZ,MAA0B,UAA1B;AACA,OAAO,mBAAP;AAEA,MAAMC,MAAM,GAAG;AACbC,EAAAA,MAAM,EAAE,yCADK;AAEbC,EAAAA,UAAU,EAAE,8BAFC;AAGbC,EAAAA,WAAW,EAAE,qCAHA;AAIbC,EAAAA,SAAS,EAAE,cAJE;AAKbC,EAAAA,aAAa,EAAE,0BALF;AAMbC,EAAAA,iBAAiB,EAAE,cANN;AAObC,EAAAA,KAAK,EAAE,2CAPM;AAQbC,EAAAA,aAAa,EAAE;AARF,CAAf;AAUA,MAAMC,GAAG,GAAGV,QAAQ,CAACW,aAAT,EAAZ;AACA,MAAMC,QAAQ,GAAGZ,QAAQ,CAACY,QAAT,EAAjB,C,CAEA;;AAOA,OAAO,SAASC,OAAT,CAAiBC,MAAjB,EAAuC;AAC5C,SAAOd,QAAQ,CACZY,QADI,GAEJG,GAFI,CAEA,YAAYD,MAFZ,EAGJE,IAHI,CAGC,OAHD,EAIJC,IAJI,CAIC,UAASC,QAAT,EAAmB;AACvB,UAAMC,IAAI,GAAGD,QAAQ,CAACE,GAAT,EAAb;;AAEA,QAAID,IAAJ,EAAU;AACR,aAAOA,IAAP;AACD;;AAED,WAAOE,UAAU,CAACP,MAAD,CAAjB;AACD,GAZI,CAAP;AAaD;;AAED,SAASO,UAAT,CAAoBP,MAApB,EAA4B;AAC1B,QAAMK,IAAI,GAAG,EAAb;AAEA,SAAOnB,QAAQ,CACZY,QADI,GAEJG,GAFI,CAEA,WAAWD,MAFX,EAGJQ,GAHI,CAGAH,IAHA,EAGMI,KAAK,IAAI;AAClB,QAAIA,KAAJ,EAAW;AACT,YAAMC,KAAK,CAACD,KAAD,CAAX;AACD;;AAED,WAAOJ,IAAP;AACD,GATI,CAAP;AAUD,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA","sourcesContent":["import * as firebase from \"firebase\";\nimport \"firebase/database\";\n\nconst config = {\n  apiKey: \"AIzaSyDp01-0TwxRjNC05CuDcpauXRyLSMv0RRw\",\n  authDomain: \"darts-yeslab.firebaseapp.com\",\n  databaseURL: \"https://darts-yeslab.firebaseio.com\",\n  projectId: \"darts-yeslab\",\n  storageBucket: \"darts-yeslab.appspot.com\",\n  messagingSenderId: \"426404952698\",\n  appId: \"1:426404952698:web:738ac9ab1342a1177419c3\",\n  measurementId: \"G-7DHLMBZXEN\"\n};\nconst app = firebase.initializeApp();\nconst database = firebase.database();\n\n// DB types\ndeclare global {\n  interface User {\n    id: string;\n  }\n}\n\nexport function getUser(userId: string): User {\n  return firebase\n    .database()\n    .ref(\"/users/\" + userId)\n    .once(\"value\")\n    .then(function(snapshot) {\n      const user = snapshot.val();\n\n      if (user) {\n        return user;\n      }\n\n      return createUser(userId);\n    });\n}\n\nfunction createUser(userId) {\n  const user = {};\n\n  return firebase\n    .database()\n    .ref(\"users/\" + userId)\n    .set(user, error => {\n      if (error) {\n        throw Error(error);\n      }\n\n      return user;\n    });\n}\n\n// const data = {\n//   games: {\n//     \"one\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"7yzh\"\n//     },\n//     \"two\": {\n//       creator: \"user_id\",\n//       timestamp: 000,\n//       code: \"8n0a\"\n//     }\n//   }\n\n// }\n"]},"metadata":{},"sourceType":"module"}